///////////////////////////////////////////////////////////////////////////////
///
/// \file BlockMatrixSuite.hpp
/// A collection of BlockMatrix tests for all LCP solvers. Makes it so I
/// don't have to copy-paste these tests all over the place and it's easy to
/// add new tests to all LCP solvers.
/// 
/// Authors: Joshua Davis
/// Copyright 2012, DigiPen Institute of Technology
///
///////////////////////////////////////////////////////////////////////////////
#include "LcpStandard.hpp"


inline void MatrixDim1Test1(BlockMat3Ref A,BlockVec3Ref b,BlockVec3Ref expected,BlockVec3Ref x0)
{
 A(0,0) = Mat3(real(65.573196),real(19.337412),real(-56.131718),real(19.337412),real(38.917751),real(-1.774694),real(-56.131718),real(-1.774694),real(57.855564));
 b[0] = Vec3(real(-293.686737), real(-300.112396), real(147.738754));
 x0[0] = Vec3(real(0.000000), real(0.000000), real(0.000000));
 expected[0] = Vec3(real(-5.231788), real(-5.234230), real(-2.682882));
}

inline void MatrixDim2Test1(BlockMat3Ref A,BlockVec3Ref b,BlockVec3Ref expected,BlockVec3Ref x0)
{
 A(0,0) = Mat3(real(199.179688),real(-0.997505),real(-50.459435),real(-0.997505),real(246.606445),real(146.453400),real(-50.459435),real(146.453400),real(396.046143));
 A(0,1) = Mat3(real(-121.963593),real(-39.198349),real(1.765457),real(4.294754),real(81.521126),real(128.783661),real(157.938095),real(182.764221),real(78.818954));
 A(1,0) = Mat3(real(-121.963593),real(4.294754),real(157.938095),real(-39.198349),real(81.521126),real(182.764221),real(1.765457),real(128.783661),real(78.818954));
 A(1,1) = Mat3(real(177.748520),real(127.059647),real(21.936089),real(127.059647),real(138.137161),real(74.055145),real(21.936089),real(74.055145),real(191.235306));
 b[0] = Vec3(real(1075.276855), real(2404.473633), real(-1271.859985));
 b[1] = Vec3(real(-1820.057617), real(-529.679932), real(1956.603638));
 x0[0] = Vec3(real(0.000000), real(0.000000), real(0.000000));
 x0[1] = Vec3(real(0.000000), real(0.000000), real(0.000000));
 expected[0] = Vec3(real(-0.524613), real(9.241310), real(-5.717032));
 expected[1] = Vec3(real(-7.891171), real(1.874752), real(6.548357));
}

inline void MatrixDim3Test1(BlockMat3Ref A,BlockVec3Ref b,BlockVec3Ref expected,BlockVec3Ref x0)
{
 A(0,0) = Mat3(real(277.471558),real(75.884773),real(113.571823),real(75.884773),real(174.426102),real(88.939743),real(113.571823),real(88.939743),real(167.770508));
 A(0,1) = Mat3(real(-20.201534),real(-159.963974),real(67.811279),real(74.282272),real(-19.114388),real(-68.456932),real(-23.556885),real(-44.884853),real(-81.348984));
 A(0,2) = Mat3(real(-11.884668),real(87.905571),real(143.443314),real(-133.188156),real(-53.063091),real(-16.679493),real(-94.651588),real(-40.553974),real(80.706726));
 A(1,0) = Mat3(real(-20.201534),real(74.282272),real(-23.556885),real(-159.963974),real(-19.114388),real(-44.884853),real(67.811279),real(-68.456932),real(-81.348984));
 A(1,1) = Mat3(real(323.059082),real(23.409468),real(-95.955597),real(23.409468),real(227.480591),real(-26.544527),real(-95.955597),real(-26.544527),real(188.483917));
 A(1,2) = Mat3(real(-29.013275),real(-11.451976),real(-82.619469),real(-54.275486),real(-119.788528),real(-105.784424),real(100.219070),real(14.626611),real(-1.722599));
 A(2,0) = Mat3(real(-11.884668),real(-133.188156),real(-94.651588),real(87.905571),real(-53.063091),real(-40.553974),real(143.443314),real(-16.679493),real(80.706726));
 A(2,1) = Mat3(real(-29.013275),real(-54.275486),real(100.219070),real(-11.451976),real(-119.788528),real(14.626611),real(-82.619469),real(-105.784424),real(-1.722599));
 A(2,2) = Mat3(real(186.313858),real(31.073904),real(69.757584),real(31.073904),real(314.889557),real(109.354202),real(69.757584),real(109.354202),real(269.381104));
 b[0] = Vec3(real(-203.797333), real(-574.284058), real(-683.420471));
 b[1] = Vec3(real(-1964.164551), real(-698.688110), real(1097.214355));
 b[2] = Vec3(real(1043.921143), real(-18.893524), real(484.903320));
 x0[0] = Vec3(real(0.000000), real(0.000000), real(0.000000));
 x0[1] = Vec3(real(0.000000), real(0.000000), real(0.000000));
 x0[2] = Vec3(real(0.000000), real(0.000000), real(0.000000));
 expected[0] = Vec3(real(-5.952025), real(8.160954), real(-3.017975));
 expected[1] = Vec3(real(-6.485488), real(-4.496292), real(3.046052));
 expected[2] = Vec3(real(5.076144), real(-0.538041), real(1.547594));
}

inline void MatrixDim4Test1(BlockMat3Ref A,BlockVec3Ref b,BlockVec3Ref expected,BlockVec3Ref x0)
{
 A(0,0) = Mat3(real(588.147583),real(-134.572144),real(61.471840),real(-134.572144),real(273.504883),real(-112.229027),real(61.471840),real(-112.229027),real(549.931091));
 A(0,1) = Mat3(real(192.577942),real(235.418350),real(-260.857117),real(-101.121597),real(-11.522029),real(44.602871),real(-49.999374),real(12.203144),real(-65.792953));
 A(0,2) = Mat3(real(-18.831253),real(-32.048195),real(-117.852875),real(142.560944),real(-3.039917),real(15.102781),real(222.387512),real(-50.234234),real(111.049606));
 A(0,3) = Mat3(real(206.716537),real(146.122925),real(-41.216438),real(-64.970200),real(-169.813721),real(-109.728600),real(20.834534),real(50.135635),real(78.640060));
 A(1,0) = Mat3(real(192.577942),real(-101.121597),real(-49.999374),real(235.418350),real(-11.522029),real(12.203144),real(-260.857117),real(44.602871),real(-65.792953));
 A(1,1) = Mat3(real(406.942078),real(157.231018),real(67.434296),real(157.231018),real(312.000000),real(-237.730560),real(67.434296),real(-237.730560),real(470.666382));
 A(1,2) = Mat3(real(-83.224770),real(-85.102074),real(55.050289),real(112.180626),real(-112.312386),real(97.401634),real(-72.669174),real(82.213181),real(-28.828510));
 A(1,3) = Mat3(real(-103.191795),real(117.816307),real(198.779510),real(100.839851),real(33.494232),real(10.581451),real(-204.581696),real(82.669586),real(72.886383));
 A(2,0) = Mat3(real(-18.831253),real(142.560944),real(222.387512),real(-32.048195),real(-3.039917),real(-50.234234),real(-117.852875),real(15.102781),real(111.049606));
 A(2,1) = Mat3(real(-83.224770),real(112.180626),real(-72.669174),real(-85.102074),real(-112.312386),real(82.213181),real(55.050289),real(97.401634),real(-28.828510));
 A(2,2) = Mat3(real(381.830688),real(36.666946),real(82.226021),real(36.666946),real(296.122681),real(-45.010471),real(82.226021),real(-45.010471),real(346.414429));
 A(2,3) = Mat3(real(30.882683),real(-2.946774),real(-28.667728),real(11.303053),real(180.628021),real(59.757545),real(-48.561119),real(-45.753635),real(47.469364));
 A(3,0) = Mat3(real(206.716537),real(-64.970200),real(20.834534),real(146.122925),real(-169.813721),real(50.135635),real(-41.216438),real(-109.728600),real(78.640060));
 A(3,1) = Mat3(real(-103.191795),real(100.839851),real(-204.581696),real(117.816307),real(33.494232),real(82.669586),real(198.779510),real(10.581451),real(72.886383));
 A(3,2) = Mat3(real(30.882683),real(11.303053),real(-48.561119),real(-2.946774),real(180.628021),real(-45.753635),real(-28.667728),real(59.757545),real(47.469364));
 A(3,3) = Mat3(real(246.917862),real(34.995438),real(-139.198532),real(34.995438),real(377.908051),real(174.055878),real(-139.198532),real(174.055878),real(433.316406));
 b[0] = Vec3(real(-5799.114258), real(3803.335938), real(3150.009277));
 b[1] = Vec3(real(-7304.000977), real(-1364.034912), real(-2564.655029));
 b[2] = Vec3(real(4860.578125), real(509.677490), real(3685.799072));
 b[3] = Vec3(real(384.749390), real(-5109.926758), real(-4587.979492));
 x0[0] = Vec3(real(0.000000), real(0.000000), real(0.000000));
 x0[1] = Vec3(real(0.000000), real(0.000000), real(0.000000));
 x0[2] = Vec3(real(0.000000), real(0.000000), real(0.000000));
 x0[3] = Vec3(real(0.000000), real(0.000000), real(0.000000));
 expected[0] = Vec3(real(-6.659444), real(0.021058), real(4.661702));
 expected[1] = Vec3(real(-6.710715), real(-0.018616), real(-8.494217));
 expected[2] = Vec3(real(4.151433), real(8.491776), real(6.834010));
 expected[3] = Vec3(real(-6.861476), real(-6.030763), real(-8.981292));
}

inline void MatrixDim4Test2(BlockMat3Ref A,BlockVec3Ref b,BlockVec3Ref expected,BlockVec3Ref x0)
{
 A(0,0) = Mat3(real(403.216248),real(65.797745),real(62.766510),real(65.797745),real(367.931274),real(-32.803322),real(62.766510),real(-32.803322),real(423.721771));
 A(0,1) = Mat3(real(107.208961),real(-119.880402),real(-99.879562),real(72.850693),real(-51.564701),real(31.006935),real(6.015743),real(82.168083),real(-26.525444));
 A(0,2) = Mat3(real(-118.144318),real(-92.395363),real(67.898331),real(-38.052544),real(39.667374),real(-121.268158),real(124.982124),real(146.456207),real(-173.967926));
 A(0,3) = Mat3(real(6.799755),real(-20.412216),real(24.421284),real(141.276108),real(176.815308),real(2.905285),real(-115.657448),real(6.686127),real(128.898941));
 A(1,0) = Mat3(real(107.208961),real(72.850693),real(6.015743),real(-119.880402),real(-51.564701),real(82.168083),real(-99.879562),real(31.006935),real(-26.525444));
 A(1,1) = Mat3(real(374.795898),real(-23.838707),real(-67.962669),real(-23.838707),real(270.352325),real(21.227631),real(-67.962669),real(21.227631),real(143.789078));
 A(1,2) = Mat3(real(-93.868019),real(101.000916),real(148.623505),real(14.117964),real(80.490257),real(3.139091),real(2.609378),real(-32.270985),real(-92.496597));
 A(1,3) = Mat3(real(1.715752),real(-41.017799),real(21.645687),real(-197.651474),real(-83.117142),real(112.960785),real(124.457047),real(75.134483),real(33.050510));
 A(2,0) = Mat3(real(-118.144318),real(-38.052544),real(124.982124),real(-92.395363),real(39.667374),real(146.456207),real(67.898331),real(-121.268158),real(-173.967926));
 A(2,1) = Mat3(real(-93.868019),real(14.117964),real(2.609378),real(101.000916),real(80.490257),real(-32.270985),real(148.623505),real(3.139091),real(-92.496597));
 A(2,2) = Mat3(real(321.958435),real(10.062195),real(-201.735352),real(10.062195),real(428.112885),real(55.615616),real(-201.735352),real(55.615616),real(480.142212));
 A(2,3) = Mat3(real(-40.103878),real(-112.776627),real(78.905594),real(-216.353821),real(79.811790),real(-34.846161),real(-64.122604),real(-111.046875),real(-74.463425));
 A(3,0) = Mat3(real(6.799755),real(141.276108),real(-115.657448),real(-20.412216),real(176.815308),real(6.686127),real(24.421284),real(2.905285),real(128.898941));
 A(3,1) = Mat3(real(1.715752),real(-197.651474),real(124.457047),real(-41.017799),real(-83.117142),real(75.134483),real(21.645687),real(112.960785),real(33.050510));
 A(3,2) = Mat3(real(-40.103878),real(-216.353821),real(-64.122604),real(-112.776627),real(79.811790),real(-111.046875),real(78.905594),real(-34.846161),real(-74.463425));
 A(3,3) = Mat3(real(445.239197),real(146.132782),real(-46.105911),real(146.132782),real(288.836060),real(-80.854309),real(-46.105911),real(-80.854309),real(164.954865));
 b[0] = Vec3(real(-5326.143555), real(1022.211060), real(1088.343872));
 b[1] = Vec3(real(-124.271072), real(2635.127686), real(1983.036377));
 b[2] = Vec3(real(1979.761230), real(2217.161621), real(-3351.246826));
 b[3] = Vec3(real(210.115356), real(976.106506), real(676.911255));
 x0[0] = Vec3(real(0.000000), real(0.000000), real(0.000000));
 x0[1] = Vec3(real(0.000000), real(0.000000), real(0.000000));
 x0[2] = Vec3(real(0.000000), real(0.000000), real(0.000000));
 x0[3] = Vec3(real(0.000000), real(0.000000), real(0.000000));
 expected[0] = Vec3(real(-9.719840), real(3.141881), real(3.165075));
 expected[1] = Vec3(real(5.115207), real(9.683828), real(5.298929));
 expected[2] = Vec3(real(-1.240577), real(2.642598), real(-7.358928));
 expected[3] = Vec3(real(4.372387), real(-6.013672), real(-9.246193));
}

inline void MatrixDim4Test3(BlockMat3Ref A,BlockVec3Ref b,BlockVec3Ref expected,BlockVec3Ref x0)
{
 A(0,0) = Mat3(real(405.042297),real(61.684048),real(-90.490257),real(61.684048),real(415.279236),real(86.342384),real(-90.490257),real(86.342384),real(424.100037));
 A(0,1) = Mat3(real(-74.172150),real(77.421768),real(-5.385380),real(-151.973206),real(70.903969),real(-106.427132),real(173.508499),real(-80.359138),real(-206.403534));
 A(0,2) = Mat3(real(-79.665237),real(-13.557083),real(308.887543),real(-2.494051),real(-147.473999),real(46.524788),real(-160.064926),real(72.446022),real(-108.357544));
 A(0,3) = Mat3(real(-95.042984),real(3.852896),real(8.802254),real(-19.552269),real(-170.974350),real(150.029968),real(-5.975061),real(-46.994911),real(-26.673000));
 A(1,0) = Mat3(real(-74.172150),real(-151.973206),real(173.508499),real(77.421768),real(70.903969),real(-80.359138),real(-5.385380),real(-106.427132),real(-206.403534));
 A(1,1) = Mat3(real(455.206665),real(-56.391682),real(-275.373566),real(-56.391682),real(139.573730),real(-74.040993),real(-275.373566),real(-74.040993),real(589.053101));
 A(1,2) = Mat3(real(-56.270325),real(200.147064),real(-147.258469),real(12.694077),real(37.101810),real(113.372284),real(-9.297508),real(-415.745270),real(-111.447754));
 A(1,3) = Mat3(real(-112.928932),real(251.161255),real(-161.830566),real(-56.518688),real(15.860022),real(37.761951),real(60.419827),real(-63.826591),real(-76.810654));
 A(2,0) = Mat3(real(-79.665237),real(-2.494051),real(-160.064926),real(-13.557083),real(-147.473999),real(72.446022),real(308.887543),real(46.524788),real(-108.357544));
 A(2,1) = Mat3(real(-56.270325),real(12.694077),real(-9.297508),real(200.147064),real(37.101810),real(-415.745270),real(-147.258469),real(113.372284),real(-111.447754));
 A(2,2) = Mat3(real(234.887009),real(139.038544),real(80.844437),real(139.038544),real(604.140503),real(208.375992),real(80.844437),real(208.375992),real(486.251099));
 A(2,3) = Mat3(real(150.223495),real(-81.924835),real(40.617432),real(155.680908),real(49.803871),real(29.777321),real(99.250763),real(-160.513641),real(123.304726));
 A(3,0) = Mat3(real(-95.042984),real(-19.552269),real(-5.975061),real(3.852896),real(-170.974350),real(-46.994911),real(8.802254),real(150.029968),real(-26.673000));
 A(3,1) = Mat3(real(-112.928932),real(-56.518688),real(60.419827),real(251.161255),real(15.860022),real(-63.826591),real(-161.830566),real(37.761951),real(-76.810654));
 A(3,2) = Mat3(real(150.223495),real(155.680908),real(99.250763),real(-81.924835),real(49.803871),real(-160.513641),real(40.617432),real(29.777321),real(123.304726));
 A(3,3) = Mat3(real(385.609589),real(-173.706909),real(159.013931),real(-173.706909),real(394.456390),real(-102.129074),real(159.013931),real(-102.129074),real(321.720367));
 b[0] = Vec3(real(2163.770752), real(-1410.667480), real(-1734.033936));
 b[1] = Vec3(real(1985.335938), real(243.224487), real(-1080.792358));
 b[2] = Vec3(real(678.403809), real(1893.906982), real(1967.097290));
 b[3] = Vec3(real(93.583130), real(1881.509644), real(-365.022919));
 x0[0] = Vec3(real(0.000000), real(0.000000), real(0.000000));
 x0[1] = Vec3(real(0.000000), real(0.000000), real(0.000000));
 x0[2] = Vec3(real(0.000000), real(0.000000), real(0.000000));
 x0[3] = Vec3(real(0.000000), real(0.000000), real(0.000000));
 expected[0] = Vec3(real(0.572832), real(4.162419), real(-8.989227));
 expected[1] = Vec3(real(9.048433), real(-5.118870), real(0.468459));
 expected[2] = Vec3(real(-4.312571), real(0.368969), real(6.470229));
 expected[3] = Vec3(real(4.243599), real(3.152867), real(-1.638539));
}

inline void MatrixDim5Test1(BlockMat3Ref A,BlockVec3Ref b,BlockVec3Ref expected,BlockVec3Ref x0)
{
 A(0,0) = Mat3(real(824.276672),real(83.479820),real(-99.986938),real(83.479820),real(435.975098),real(124.988205),real(-99.986938),real(124.988205),real(571.093811));
 A(0,1) = Mat3(real(1.225319),real(-34.171638),real(-7.976637),real(-202.729004),real(-27.123514),real(-169.539780),real(-174.314835),real(104.693199),real(-303.329346));
 A(0,2) = Mat3(real(69.798950),real(-142.234222),real(-85.029892),real(-51.414448),real(-90.901352),real(195.674744),real(-232.348358),real(132.578079),real(101.837723));
 A(0,3) = Mat3(real(22.819279),real(-205.553314),real(-41.952171),real(7.720427),real(210.180176),real(-158.319092),real(-44.470779),real(-70.594055),real(-39.038399));
 A(0,4) = Mat3(real(-11.279701),real(111.428490),real(95.276337),real(-112.061714),real(118.121780),real(82.851692),real(-81.017792),real(169.393341),real(359.309631));
 A(1,0) = Mat3(real(1.225319),real(-202.729004),real(-174.314835),real(-34.171638),real(-27.123514),real(104.693199),real(-7.976637),real(-169.539780),real(-303.329346));
 A(1,1) = Mat3(real(512.003662),real(72.685791),real(199.208405),real(72.685791),real(497.660065),real(-177.198608),real(199.208405),real(-177.198608),real(602.879150));
 A(1,2) = Mat3(real(-12.271774),real(152.119751),real(-22.348698),real(-306.946259),real(86.375969),real(128.959106),real(365.931732),real(-220.904999),real(-213.516632));
 A(1,3) = Mat3(real(-193.782822),real(-80.197830),real(230.089417),real(42.225807),real(-23.104019),real(-73.975792),real(-141.330902),real(140.708694),real(211.133942));
 A(1,4) = Mat3(real(-63.172962),real(100.873123),real(-97.770348),real(98.921188),real(41.388573),real(-90.855774),real(-52.403690),real(28.004456),real(-46.872612));
 A(2,0) = Mat3(real(69.798950),real(-51.414448),real(-232.348358),real(-142.234222),real(-90.901352),real(132.578079),real(-85.029892),real(195.674744),real(101.837723));
 A(2,1) = Mat3(real(-12.271774),real(-306.946259),real(365.931732),real(152.119751),real(86.375969),real(-220.904999),real(-22.348698),real(128.959106),real(-213.516632));
 A(2,2) = Mat3(real(462.135406),real(-262.994965),real(-106.691353),real(-262.994965),real(470.329224),real(112.092369),real(-106.691353),real(112.092369),real(394.294678));
 A(2,3) = Mat3(real(70.696762),real(162.296448),real(26.456146),real(-29.772270),real(-346.982819),real(74.981171),real(4.917015),real(123.371902),real(-152.798264));
 A(2,4) = Mat3(real(-127.486923),real(-25.363808),real(-111.002831),real(-12.760269),real(-102.680817),real(41.322456),real(-2.111504),real(48.135002),real(-12.961170));
 A(3,0) = Mat3(real(22.819279),real(7.720427),real(-44.470779),real(-205.553314),real(210.180176),real(-70.594055),real(-41.952171),real(-158.319092),real(-39.038399));
 A(3,1) = Mat3(real(-193.782822),real(42.225807),real(-141.330902),real(-80.197830),real(-23.104019),real(140.708694),real(230.089417),real(-73.975792),real(211.133942));
 A(3,2) = Mat3(real(70.696762),real(-29.772270),real(4.917015),real(162.296448),real(-346.982819),real(123.371902),real(26.456146),real(74.981171),real(-152.798264));
 A(3,3) = Mat3(real(537.223816),real(-131.393082),real(-140.662766),real(-131.393082),real(581.763428),real(-159.999786),real(-140.662766),real(-159.999786),real(587.361145));
 A(3,4) = Mat3(real(117.158798),real(-260.350891),real(-112.531830),real(-114.340767),real(192.899841),real(-144.047379),real(231.207199),real(69.319221),real(97.715729));
 A(4,0) = Mat3(real(-11.279701),real(-112.061714),real(-81.017792),real(111.428490),real(118.121780),real(169.393341),real(95.276337),real(82.851692),real(359.309631));
 A(4,1) = Mat3(real(-63.172962),real(98.921188),real(-52.403690),real(100.873123),real(41.388573),real(28.004456),real(-97.770348),real(-90.855774),real(-46.872612));
 A(4,2) = Mat3(real(-127.486923),real(-12.760269),real(-2.111504),real(-25.363808),real(-102.680817),real(48.135002),real(-111.002831),real(41.322456),real(-12.961170));
 A(4,3) = Mat3(real(117.158798),real(-114.340767),real(231.207199),real(-260.350891),real(192.899841),real(69.319221),real(-112.531830),real(-144.047379),real(97.715729));
 A(4,4) = Mat3(real(596.572144),real(-140.017944),real(12.240882),real(-140.017944),real(570.434875),real(127.319260),real(12.240882),real(127.319260),real(675.575012));
 b[0] = Vec3(real(-5703.544922), real(3088.377686), real(-6150.499023));
 b[1] = Vec3(real(-810.272339), real(-7283.326660), real(4980.104004));
 b[2] = Vec3(real(6997.118164), real(-4310.604004), real(1019.463684));
 b[3] = Vec3(real(-2937.034668), real(9267.132813), real(-1293.479004));
 b[4] = Vec3(real(-4086.106934), real(-438.447144), real(-5976.798828));
 x0[0] = Vec3(real(0.000000), real(0.000000), real(0.000000));
 x0[1] = Vec3(real(0.000000), real(0.000000), real(0.000000));
 x0[2] = Vec3(real(0.000000), real(0.000000), real(0.000000));
 x0[3] = Vec3(real(0.000000), real(0.000000), real(0.000000));
 x0[4] = Vec3(real(0.000000), real(0.000000), real(0.000000));
 expected[0] = Vec3(real(-7.908872), real(6.272469), real(-9.699697));
 expected[1] = Vec3(real(-2.525407), real(-8.747520), real(-5.211646));
 expected[2] = Vec3(real(7.257607), real(-2.435072), real(2.670064));
 expected[3] = Vec3(real(-8.237251), real(3.788873), real(2.208625));
 expected[4] = Vec3(real(-3.779107), real(-1.921751), real(-4.305857));
}

inline void MatrixDim6Test1(BlockMat3Ref A,BlockVec3Ref b,BlockVec3Ref expected,BlockVec3Ref x0)
{
 A(0,0) = Mat3(real(738.180664),real(-69.121536),real(-72.833389),real(-69.121536),real(556.724792),real(-289.115875),real(-72.833389),real(-289.115875),real(634.672852));
 A(0,1) = Mat3(real(-114.062881),real(-211.650620),real(133.820038),real(-110.522354),real(163.735001),real(-160.482376),real(115.015953),real(41.315567),real(59.002892));
 A(0,2) = Mat3(real(-327.485229),real(-65.929367),real(127.880188),real(79.588699),real(-38.279362),real(-295.481659),real(-2.323555),real(-49.510288),real(84.232254));
 A(0,3) = Mat3(real(-181.111206),real(97.166901),real(-241.458862),real(285.700134),real(72.498833),real(-23.447214),real(-218.190613),real(35.018356),real(44.472389));
 A(0,4) = Mat3(real(102.105942),real(-85.810966),real(354.641357),real(-26.257446),real(-96.341270),real(85.598068),real(70.442627),real(214.343826),real(-1.901196));
 A(0,5) = Mat3(real(10.226414),real(297.324554),real(-50.159908),real(119.352852),real(-40.705864),real(112.907997),real(-73.668930),real(-267.004822),real(-42.509621));
 A(1,0) = Mat3(real(-114.062881),real(-110.522354),real(115.015953),real(-211.650620),real(163.735001),real(41.315567),real(133.820038),real(-160.482376),real(59.002892));
 A(1,1) = Mat3(real(572.283752),real(63.344391),real(-68.770676),real(63.344391),real(534.784058),real(-71.377808),real(-68.770676),real(-71.377808),real(548.602661));
 A(1,2) = Mat3(real(293.931549),real(-35.476540),real(-37.488617),real(247.541321),real(-197.238403),real(-316.452026),real(-5.076237),real(-55.269669),real(208.083344));
 A(1,3) = Mat3(real(-218.879349),real(-114.315323),real(369.557068),real(-13.897701),real(137.798325),real(225.016342),real(-303.375793),real(-154.285751),real(-70.441498));
 A(1,4) = Mat3(real(147.434601),real(-78.347633),real(0.083538),real(80.022583),real(1.523885),real(119.189354),real(218.100403),real(-10.919651),real(15.311577));
 A(1,5) = Mat3(real(-298.644745),real(-96.275200),real(47.694801),real(-133.395157),real(-223.264130),real(6.008867),real(-153.890610),real(-80.700577),real(-127.413925));
 A(2,0) = Mat3(real(-327.485229),real(79.588699),real(-2.323555),real(-65.929367),real(-38.279362),real(-49.510288),real(127.880188),real(-295.481659),real(84.232254));
 A(2,1) = Mat3(real(293.931549),real(247.541321),real(-5.076237),real(-35.476540),real(-197.238403),real(-55.269669),real(-37.488617),real(-316.452026),real(208.083344));
 A(2,2) = Mat3(real(817.320923),real(57.298294),real(-37.540070),real(57.298294),real(524.982117),real(216.819824),real(-37.540070),real(216.819824),real(615.070740));
 A(2,3) = Mat3(real(-130.733582),real(-50.170841),real(472.342377),real(97.012115),real(-151.420532),real(-52.702824),real(5.732307),real(-237.216934),real(-227.176605));
 A(2,4) = Mat3(real(64.466835),real(-206.811859),real(37.837631),real(331.168884),real(-171.382004),real(-270.524689),real(-16.234175),real(88.865395),real(-142.325317));
 A(2,5) = Mat3(real(-337.750000),real(-428.345947),real(105.630280),real(207.764465),real(54.821846),real(-31.472782),real(-79.201286),real(49.301262),real(-60.794937));
 A(3,0) = Mat3(real(-181.111206),real(285.700134),real(-218.190613),real(97.166901),real(72.498833),real(35.018356),real(-241.458862),real(-23.447214),real(44.472389));
 A(3,1) = Mat3(real(-218.879349),real(-13.897701),real(-303.375793),real(-114.315323),real(137.798325),real(-154.285751),real(369.557068),real(225.016342),real(-70.441498));
 A(3,2) = Mat3(real(-130.733582),real(97.012115),real(5.732307),real(-50.170841),real(-151.420532),real(-237.216934),real(472.342377),real(-52.702824),real(-227.176605));
 A(3,3) = Mat3(real(560.859192),real(16.564260),real(-238.741150),real(16.564260),real(337.229370),real(-25.085068),real(-238.741150),real(-25.085068),real(708.270081));
 A(3,4) = Mat3(real(-303.231812),real(53.783737),real(-169.397736),real(-214.114655),real(-17.295135),real(144.641190),real(6.196774),real(11.473129),real(-4.312262));
 A(3,5) = Mat3(real(188.385056),real(113.512161),real(89.429398),real(-3.269157),real(-23.000950),real(51.468140),real(-128.926056),real(-49.962120),real(87.738129));
 A(4,0) = Mat3(real(102.105942),real(-26.257446),real(70.442627),real(-85.810966),real(-96.341270),real(214.343826),real(354.641357),real(85.598068),real(-1.901196));
 A(4,1) = Mat3(real(147.434601),real(80.022583),real(218.100403),real(-78.347633),real(1.523885),real(-10.919651),real(0.083538),real(119.189354),real(15.311577));
 A(4,2) = Mat3(real(64.466835),real(331.168884),real(-16.234175),real(-206.811859),real(-171.382004),real(88.865395),real(37.837631),real(-270.524689),real(-142.325317));
 A(4,3) = Mat3(real(-303.231812),real(-214.114655),real(6.196774),real(53.783737),real(-17.295135),real(11.473129),real(-169.397736),real(144.641190),real(-4.312262));
 A(4,4) = Mat3(real(930.277405),real(-312.975739),real(50.416260),real(-312.975739),real(507.946136),real(-154.356140),real(50.416260),real(-154.356140),real(824.676880));
 A(4,5) = Mat3(real(71.158417),real(-117.102287),real(-182.466599),real(76.902649),real(68.689255),real(-10.335362),real(-143.578079),real(-63.513657),real(-264.445587));
 A(5,0) = Mat3(real(10.226414),real(119.352852),real(-73.668930),real(297.324554),real(-40.705864),real(-267.004822),real(-50.159908),real(112.907997),real(-42.509621));
 A(5,1) = Mat3(real(-298.644745),real(-133.395157),real(-153.890610),real(-96.275200),real(-223.264130),real(-80.700577),real(47.694801),real(6.008867),real(-127.413925));
 A(5,2) = Mat3(real(-337.750000),real(207.764465),real(-79.201286),real(-428.345947),real(54.821846),real(49.301262),real(105.630280),real(-31.472782),real(-60.794937));
 A(5,3) = Mat3(real(188.385056),real(-3.269157),real(-128.926056),real(113.512161),real(-23.000950),real(-49.962120),real(89.429398),real(51.468140),real(87.738129));
 A(5,4) = Mat3(real(71.158417),real(76.902649),real(-143.578079),real(-117.102287),real(68.689255),real(-63.513657),real(-182.466599),real(-10.335362),real(-264.445587));
 A(5,5) = Mat3(real(642.389893),real(247.432159),real(86.147034),real(247.432159),real(651.696655),real(-94.793213),real(86.147034),real(-94.793213),real(512.128601));
 b[0] = Vec3(real(-10684.583984), real(-1463.728027), real(5071.267578));
 b[1] = Vec3(real(-166.714844), real(4301.422852), real(-4305.010254));
 b[2] = Vec3(real(3410.586670), real(-2026.507080), real(-3519.719727));
 b[3] = Vec3(real(2159.749268), real(3145.006592), real(5339.965332));
 b[4] = Vec3(real(-8350.785156), real(5624.144531), real(-8723.628906));
 b[5] = Vec3(real(2907.131104), real(-4554.905762), real(7129.994141));
 x0[0] = Vec3(real(0.000000), real(0.000000), real(0.000000));
 x0[1] = Vec3(real(0.000000), real(0.000000), real(0.000000));
 x0[2] = Vec3(real(0.000000), real(0.000000), real(0.000000));
 x0[3] = Vec3(real(0.000000), real(0.000000), real(0.000000));
 x0[4] = Vec3(real(0.000000), real(0.000000), real(0.000000));
 x0[5] = Vec3(real(0.000000), real(0.000000), real(0.000000));
 expected[0] = Vec3(real(-9.428083), real(-9.544053), real(2.903226));
 expected[1] = Vec3(real(2.108524), real(6.331675), real(3.721122));
 expected[2] = Vec3(real(4.647664), real(2.768334), real(-4.853359));
 expected[3] = Vec3(real(-0.539262), real(7.158727), real(-2.828150));
 expected[4] = Vec3(real(-7.274087), real(4.545122), real(-2.150029));
 expected[5] = Vec3(real(9.025849), real(0.108341), real(9.385357));
}

inline void MatrixDim7Test1(BlockMat3Ref A,BlockVec3Ref b,BlockVec3Ref expected,BlockVec3Ref x0)
{
 A(0,0) = Mat3(real(520.834167),real(253.305115),real(-49.970455),real(253.305115),real(653.086365),real(-62.243408),real(-49.970455),real(-62.243408),real(468.626251));
 A(0,1) = Mat3(real(-54.942955),real(-153.067444),real(-106.566177),real(110.691422),real(-87.306717),real(-350.197479),real(52.343155),real(109.603363),real(39.112953));
 A(0,2) = Mat3(real(-143.568222),real(22.851624),real(283.722473),real(-21.951664),real(78.442528),real(368.449646),real(-101.148605),real(-106.222450),real(-79.579926));
 A(0,3) = Mat3(real(81.486603),real(-84.534569),real(69.043121),real(51.417610),real(-13.704773),real(126.282448),real(-147.519043),real(202.776749),real(-25.071304));
 A(0,4) = Mat3(real(-28.916874),real(-45.830288),real(-93.256577),real(26.353884),real(-49.773270),real(27.345654),real(-218.746582),real(-172.832550),real(2.798607));
 A(0,5) = Mat3(real(-97.060120),real(-52.514072),real(87.977516),real(-168.620392),real(-140.785065),real(197.250443),real(130.185394),real(161.618866),real(212.917419));
 A(0,6) = Mat3(real(25.757896),real(-121.095909),real(127.460068),real(-7.608324),real(43.182072),real(-108.624054),real(78.253006),real(-33.841843),real(120.056694));
 A(1,0) = Mat3(real(-54.942955),real(110.691422),real(52.343155),real(-153.067444),real(-87.306717),real(109.603363),real(-106.566177),real(-350.197479),real(39.112953));
 A(1,1) = Mat3(real(778.354004),real(-190.091873),real(120.281250),real(-190.091873),real(657.336548),real(0.219765),real(120.281250),real(0.219765),real(714.305359));
 A(1,2) = Mat3(real(31.974295),real(-242.692871),real(-142.898285),real(-0.279114),real(-120.959023),real(166.052429),real(-60.093369),real(-290.523010),real(-83.496857));
 A(1,3) = Mat3(real(-0.339291),real(-13.911553),real(-136.591797),real(-113.046158),real(-130.589691),real(29.601162),real(89.708984),real(58.869133),real(-184.939423));
 A(1,4) = Mat3(real(116.885391),real(-35.438156),real(-277.441040),real(69.330414),real(-297.286072),real(73.377518),real(56.040970),real(375.685730),real(-298.238342));
 A(1,5) = Mat3(real(64.814095),real(-92.954300),real(100.359352),real(89.144989),real(35.125557),real(82.877243),real(169.397552),real(110.865990),real(84.734482));
 A(1,6) = Mat3(real(69.604904),real(-14.790810),real(114.584206),real(-75.909889),real(-50.011173),real(23.725269),real(-138.148117),real(7.226984),real(135.775696));
 A(2,0) = Mat3(real(-143.568222),real(-21.951664),real(-101.148605),real(22.851624),real(78.442528),real(-106.222450),real(283.722473),real(368.449646),real(-79.579926));
 A(2,1) = Mat3(real(31.974295),real(-0.279114),real(-60.093369),real(-242.692871),real(-120.959023),real(-290.523010),real(-142.898285),real(166.052429),real(-83.496857));
 A(2,2) = Mat3(real(733.076294),real(217.048859),real(63.849030),real(217.048859),real(514.664978),real(111.066269),real(63.849030),real(111.066269),real(905.877686));
 A(2,3) = Mat3(real(-47.420063),real(-86.835770),real(98.928696),real(-82.946785),real(-35.388092),real(14.021580),real(114.704681),real(-114.540321),real(84.112396));
 A(2,4) = Mat3(real(98.078667),real(-199.387283),real(72.399643),real(-185.118042),real(64.790779),real(356.512085),real(-100.725388),real(-166.305084),real(52.290154));
 A(2,5) = Mat3(real(-39.997421),real(-384.075439),real(-382.411011),real(-97.987068),real(-150.276978),real(-204.365555),real(-113.840820),real(-200.287170),real(109.811043));
 A(2,6) = Mat3(real(72.751694),real(-14.237640),real(-114.413124),real(29.259682),real(55.885559),real(57.702023),real(63.521767),real(42.174435),real(118.475769));
 A(3,0) = Mat3(real(81.486603),real(51.417610),real(-147.519043),real(-84.534569),real(-13.704773),real(202.776749),real(69.043121),real(126.282448),real(-25.071304));
 A(3,1) = Mat3(real(-0.339291),real(-113.046158),real(89.708984),real(-13.911553),real(-130.589691),real(58.869133),real(-136.591797),real(29.601162),real(-184.939423));
 A(3,2) = Mat3(real(-47.420063),real(-82.946785),real(114.704681),real(-86.835770),real(-35.388092),real(-114.540321),real(98.928696),real(14.021580),real(84.112396));
 A(3,3) = Mat3(real(748.853577),real(-90.057144),real(85.179199),real(-90.057144),real(600.514709),real(116.777725),real(85.179199),real(116.777725),real(467.600616));
 A(3,4) = Mat3(real(139.960968),real(214.498123),real(-63.889900),real(-114.360893),real(184.027390),real(-52.766964),real(27.591991),real(-108.178444),real(76.645538));
 A(3,5) = Mat3(real(-248.163483),real(-246.894577),real(-120.996323),real(-137.821564),real(255.420044),real(58.926544),real(75.035545),real(-157.931915),real(-177.761292));
 A(3,6) = Mat3(real(250.251221),real(-90.860680),real(-92.046036),real(122.112839),real(156.255188),real(-253.891479),real(95.252800),real(82.343582),real(-156.284653));
 A(4,0) = Mat3(real(-28.916874),real(26.353884),real(-218.746582),real(-45.830288),real(-49.773270),real(-172.832550),real(-93.256577),real(27.345654),real(2.798607));
 A(4,1) = Mat3(real(116.885391),real(69.330414),real(56.040970),real(-35.438156),real(-297.286072),real(375.685730),real(-277.441040),real(73.377518),real(-298.238342));
 A(4,2) = Mat3(real(98.078667),real(-185.118042),real(-100.725388),real(-199.387283),real(64.790779),real(-166.305084),real(72.399643),real(356.512085),real(52.290154));
 A(4,3) = Mat3(real(139.960968),real(-114.360893),real(27.591991),real(214.498123),real(184.027390),real(-108.178444),real(-63.889900),real(-52.766964),real(76.645538));
 A(4,4) = Mat3(real(695.556824),real(96.523750),real(-174.372406),real(96.523750),real(796.985107),real(-107.691833),real(-174.372406),real(-107.691833),real(830.225464));
 A(4,5) = Mat3(real(4.645164),real(-50.329903),real(-181.360382),real(-33.117298),real(208.571411),real(20.833742),real(-12.400795),real(-312.071960),real(-139.114731));
 A(4,6) = Mat3(real(-27.263008),real(269.832977),real(-257.345459),real(-122.539032),real(191.771011),real(29.435604),real(75.923325),real(-110.648605),real(-238.704346));
 A(5,0) = Mat3(real(-97.060120),real(-168.620392),real(130.185394),real(-52.514072),real(-140.785065),real(161.618866),real(87.977516),real(197.250443),real(212.917419));
 A(5,1) = Mat3(real(64.814095),real(89.144989),real(169.397552),real(-92.954300),real(35.125557),real(110.865990),real(100.359352),real(82.877243),real(84.734482));
 A(5,2) = Mat3(real(-39.997421),real(-97.987068),real(-113.840820),real(-384.075439),real(-150.276978),real(-200.287170),real(-382.411011),real(-204.365555),real(109.811043));
 A(5,3) = Mat3(real(-248.163483),real(-137.821564),real(75.035545),real(-246.894577),real(255.420044),real(-157.931915),real(-120.996323),real(58.926544),real(-177.761292));
 A(5,4) = Mat3(real(4.645164),real(-33.117298),real(-12.400795),real(-50.329903),real(208.571411),real(-312.071960),real(-181.360382),real(20.833742),real(-139.114731));
 A(5,5) = Mat3(real(651.698914),real(85.241859),real(22.180359),real(85.241859),real(763.410889),real(283.527161),real(22.180359),real(283.527161),real(680.544128));
 A(5,6) = Mat3(real(-198.112915),real(37.109795),real(256.004822),real(-3.857130),real(76.478058),real(206.978592),real(-129.292130),real(-126.735191),real(133.699829));
 A(6,0) = Mat3(real(25.757896),real(-7.608324),real(78.253006),real(-121.095909),real(43.182072),real(-33.841843),real(127.460068),real(-108.624054),real(120.056694));
 A(6,1) = Mat3(real(69.604904),real(-75.909889),real(-138.148117),real(-14.790810),real(-50.011173),real(7.226984),real(114.584206),real(23.725269),real(135.775696));
 A(6,2) = Mat3(real(72.751694),real(29.259682),real(63.521767),real(-14.237640),real(55.885559),real(42.174435),real(-114.413124),real(57.702023),real(118.475769));
 A(6,3) = Mat3(real(250.251221),real(122.112839),real(95.252800),real(-90.860680),real(156.255188),real(82.343582),real(-92.046036),real(-253.891479),real(-156.284653));
 A(6,4) = Mat3(real(-27.263008),real(-122.539032),real(75.923325),real(269.832977),real(191.771011),real(-110.648605),real(-257.345459),real(29.435604),real(-238.704346));
 A(6,5) = Mat3(real(-198.112915),real(-3.857130),real(-129.292130),real(37.109795),real(76.478058),real(-126.735191),real(256.004822),real(206.978592),real(133.699829));
 A(6,6) = Mat3(real(636.185181),real(83.197517),real(-95.029533),real(83.197517),real(771.662170),real(-100.533417),real(-95.029533),real(-100.533417),real(927.391418));
 b[0] = Vec3(real(4636.175293), real(9313.095703), real(-6506.858398));
 b[1] = Vec3(real(-10670.978516), real(4808.703125), real(-12346.207031));
 b[2] = Vec3(real(7073.612305), real(9509.689453), real(12013.188477));
 b[3] = Vec3(real(-3835.954590), real(-8939.662109), real(1145.882813));
 b[4] = Vec3(real(-2749.029053), real(-9615.339844), real(13293.879883));
 b[5] = Vec3(real(-4667.517090), real(-10374.117188), real(-1377.510498));
 b[6] = Vec3(real(-5401.958984), real(-7120.755859), real(-6087.915527));
 x0[0] = Vec3(real(0.000000), real(0.000000), real(0.000000));
 x0[1] = Vec3(real(0.000000), real(0.000000), real(0.000000));
 x0[2] = Vec3(real(0.000000), real(0.000000), real(0.000000));
 x0[3] = Vec3(real(0.000000), real(0.000000), real(0.000000));
 x0[4] = Vec3(real(0.000000), real(0.000000), real(0.000000));
 x0[5] = Vec3(real(0.000000), real(0.000000), real(0.000000));
 x0[6] = Vec3(real(0.000000), real(0.000000), real(0.000000));
 expected[0] = Vec3(real(3.925596), real(8.013245), real(-7.512131));
 expected[1] = Vec3(real(-8.734092), real(1.087374), real(-5.135350));
 expected[2] = Vec3(real(8.682821), real(-2.841578), real(5.796381));
 expected[3] = Vec3(real(-3.885311), real(-8.818323), real(-6.236457));
 expected[4] = Vec3(real(-4.880825), real(-3.604541), real(8.599811));
 expected[5] = Vec3(real(-2.291024), real(1.760613), real(-0.171209));
 expected[6] = Vec3(real(-8.140813), real(-3.650929), real(-6.725364));
}

inline void MatrixDim8Test1(BlockMat3Ref A,BlockVec3Ref b,BlockVec3Ref expected,BlockVec3Ref x0)
{
 A(0,0) = Mat3(real(772.979065),real(138.236450),real(-95.712921),real(138.236450),real(817.619263),real(236.894852),real(-95.712921),real(236.894852),real(913.934326));
 A(0,1) = Mat3(real(159.313751),real(-83.644775),real(-44.530209),real(-201.826401),real(-297.042084),real(-162.071487),real(176.592926),real(-59.090096),real(-294.984192));
 A(0,2) = Mat3(real(-167.001297),real(120.956322),real(-424.936096),real(163.325058),real(-291.842194),real(99.269302),real(-82.269440),real(-214.777191),real(92.357727));
 A(0,3) = Mat3(real(61.786674),real(98.481720),real(25.254187),real(56.383209),real(-63.037769),real(-134.379669),real(29.005466),real(27.662453),real(59.812344));
 A(0,4) = Mat3(real(-117.771393),real(195.918793),real(-174.179077),real(60.319717),real(-256.296967),real(267.576874),real(270.740845),real(104.325089),real(21.289490));
 A(0,5) = Mat3(real(-103.556732),real(391.515442),real(-64.025063),real(137.946381),real(137.121307),real(215.305817),real(86.686760),real(-29.461632),real(52.113266));
 A(0,6) = Mat3(real(184.968353),real(81.503998),real(-210.353561),real(-66.056854),real(209.900330),real(-330.799530),real(-120.747971),real(-352.219940),real(-66.444229));
 A(0,7) = Mat3(real(13.540226),real(-44.569321),real(-205.185364),real(200.745087),real(-252.523224),real(1.681608),real(-50.982849),real(-250.236374),real(304.973022));
 A(1,0) = Mat3(real(159.313751),real(-201.826401),real(176.592926),real(-83.644775),real(-297.042084),real(-59.090096),real(-44.530209),real(-162.071487),real(-294.984192));
 A(1,1) = Mat3(real(895.807861),real(382.922913),real(-138.485046),real(382.922913),real(727.446472),real(110.337326),real(-138.485046),real(110.337326),real(761.614014));
 A(1,2) = Mat3(real(6.822308),real(140.430695),real(-244.850327),real(-6.320305),real(35.937607),real(-203.235260),real(128.245514),real(223.144730),real(-83.551369));
 A(1,3) = Mat3(real(72.251343),real(0.995087),real(-138.830917),real(-24.025566),real(50.103786),real(28.432625),real(236.714722),real(271.073334),real(5.637970));
 A(1,4) = Mat3(real(-83.988541),real(152.020676),real(-99.117401),real(-82.149483),real(155.712250),real(-39.097633),real(-187.728027),real(186.222107),real(-428.209442));
 A(1,5) = Mat3(real(138.640457),real(302.368347),real(-241.660919),real(-3.644039),real(152.135086),real(-74.395111),real(-43.168846),real(-43.214607),real(-18.334332));
 A(1,6) = Mat3(real(203.872513),real(-374.184448),real(250.231293),real(64.765259),real(-162.263138),real(384.771606),real(164.935623),real(166.212952),real(80.857788));
 A(1,7) = Mat3(real(119.772461),real(277.950531),real(338.472046),real(30.831856),real(290.153961),real(267.308319),real(-59.478081),real(15.850964),real(-104.486237));
 A(2,0) = Mat3(real(-167.001297),real(163.325058),real(-82.269440),real(120.956322),real(-291.842194),real(-214.777191),real(-424.936096),real(99.269302),real(92.357727));
 A(2,1) = Mat3(real(6.822308),real(-6.320305),real(128.245514),real(140.430695),real(35.937607),real(223.144730),real(-244.850327),real(-203.235260),real(-83.551369));
 A(2,2) = Mat3(real(662.875854),real(122.296410),real(-99.583397),real(122.296410),real(893.453003),real(-293.406250),real(-99.583397),real(-293.406250),real(765.263428));
 A(2,3) = Mat3(real(164.237427),real(83.984306),real(27.365406),real(54.946564),real(-80.723366),real(94.435234),real(-38.992737),real(-196.063232),real(-45.213036));
 A(2,4) = Mat3(real(36.233315),real(-205.301758),real(-72.632950),real(-178.279510),real(-24.620964),real(-218.472488),real(-44.318554),real(-46.871048),real(274.001678));
 A(2,5) = Mat3(real(109.334244),real(18.909573),real(-126.973396),real(350.520355),real(-117.138313),real(-50.723366),real(27.268951),real(-175.375946),real(266.815735));
 A(2,6) = Mat3(real(-175.289825),real(-16.426910),real(25.870277),real(28.969120),real(152.040390),real(64.373894),real(53.041393),real(195.511292),real(-114.917282));
 A(2,7) = Mat3(real(-77.939354),real(178.658264),real(239.543823),real(-3.526421),real(266.792694),real(-282.877625),real(143.107010),real(-198.409943),real(-45.964851));
 A(3,0) = Mat3(real(61.786674),real(56.383209),real(29.005466),real(98.481720),real(-63.037769),real(27.662453),real(25.254187),real(-134.379669),real(59.812344));
 A(3,1) = Mat3(real(72.251343),real(-24.025566),real(236.714722),real(0.995087),real(50.103786),real(271.073334),real(-138.830917),real(28.432625),real(5.637970));
 A(3,2) = Mat3(real(164.237427),real(54.946564),real(-38.992737),real(83.984306),real(-80.723366),real(-196.063232),real(27.365406),real(94.435234),real(-45.213036));
 A(3,3) = Mat3(real(844.982727),real(149.030136),real(-124.524918),real(149.030136),real(710.994507),real(-102.223175),real(-124.524918),real(-102.223175),real(695.942383));
 A(3,4) = Mat3(real(2.074938),real(239.381042),real(-219.882568),real(99.252594),real(-52.872528),real(-381.921387),real(122.174522),real(99.034729),real(20.433893));
 A(3,5) = Mat3(real(254.902313),real(254.548798),real(-122.703903),real(-145.929871),real(166.822403),real(-60.000782),real(-201.353180),real(-24.744934),real(-109.390854));
 A(3,6) = Mat3(real(-29.803934),real(-271.109802),real(35.991051),real(39.490429),real(-295.997559),real(54.226742),real(-265.186279),real(200.520920),real(-195.749161));
 A(3,7) = Mat3(real(-44.807171),real(49.193714),real(-86.210236),real(-404.673798),real(-40.797577),real(39.505875),real(-197.906464),real(44.263531),real(-54.136658));
 A(4,0) = Mat3(real(-117.771393),real(60.319717),real(270.740845),real(195.918793),real(-256.296967),real(104.325089),real(-174.179077),real(267.576874),real(21.289490));
 A(4,1) = Mat3(real(-83.988541),real(-82.149483),real(-187.728027),real(152.020676),real(155.712250),real(186.222107),real(-99.117401),real(-39.097633),real(-428.209442));
 A(4,2) = Mat3(real(36.233315),real(-178.279510),real(-44.318554),real(-205.301758),real(-24.620964),real(-46.871048),real(-72.632950),real(-218.472488),real(274.001678));
 A(4,3) = Mat3(real(2.074938),real(99.252594),real(122.174522),real(239.381042),real(-52.872528),real(99.034729),real(-219.882568),real(-381.921387),real(20.433893));
 A(4,4) = Mat3(real(638.471497),real(-67.556236),real(24.958633),real(-67.556236),real(946.619629),real(-185.252945),real(24.958633),real(-185.252945),real(710.836792));
 A(4,5) = Mat3(real(-188.270203),real(-6.013832),real(-83.709045),real(-269.368958),real(79.623711),real(-16.455818),real(61.921051),real(3.455354),real(7.809357));
 A(4,6) = Mat3(real(-132.482971),real(-324.963562),real(34.220558),real(-27.877882),real(-159.691879),real(319.620972),real(-118.589294),real(73.855682),real(47.392464));
 A(4,7) = Mat3(real(-182.773209),real(-253.330185),real(292.455170),real(-13.760731),real(-10.092712),real(-140.026932),real(234.101196),real(141.093765),real(-93.105217));
 A(5,0) = Mat3(real(-103.556732),real(137.946381),real(86.686760),real(391.515442),real(137.121307),real(-29.461632),real(-64.025063),real(215.305817),real(52.113266));
 A(5,1) = Mat3(real(138.640457),real(-3.644039),real(-43.168846),real(302.368347),real(152.135086),real(-43.214607),real(-241.660919),real(-74.395111),real(-18.334332));
 A(5,2) = Mat3(real(109.334244),real(350.520355),real(27.268951),real(18.909573),real(-117.138313),real(-175.375946),real(-126.973396),real(-50.723366),real(266.815735));
 A(5,3) = Mat3(real(254.902313),real(-145.929871),real(-201.353180),real(254.548798),real(166.822403),real(-24.744934),real(-122.703903),real(-60.000782),real(-109.390854));
 A(5,4) = Mat3(real(-188.270203),real(-269.368958),real(61.921051),real(-6.013832),real(79.623711),real(3.455354),real(-83.709045),real(-16.455818),real(7.809357));
 A(5,5) = Mat3(real(862.841492),real(-118.721970),real(160.328720),real(-118.721970),real(849.436707),real(-83.487770),real(160.328720),real(-83.487770),real(697.742737));
 A(5,6) = Mat3(real(18.232330),real(165.505447),real(-181.441620),real(274.606476),real(-269.345917),real(94.167084),real(189.106033),real(407.200439),real(-176.861267));
 A(5,7) = Mat3(real(137.881577),real(247.737000),real(38.357529),real(207.441086),real(-22.098175),real(65.562012),real(119.870560),real(-249.249252),real(-208.048676));
 A(6,0) = Mat3(real(184.968353),real(-66.056854),real(-120.747971),real(81.503998),real(209.900330),real(-352.219940),real(-210.353561),real(-330.799530),real(-66.444229));
 A(6,1) = Mat3(real(203.872513),real(64.765259),real(164.935623),real(-374.184448),real(-162.263138),real(166.212952),real(250.231293),real(384.771606),real(80.857788));
 A(6,2) = Mat3(real(-175.289825),real(28.969120),real(53.041393),real(-16.426910),real(152.040390),real(195.511292),real(25.870277),real(64.373894),real(-114.917282));
 A(6,3) = Mat3(real(-29.803934),real(39.490429),real(-265.186279),real(-271.109802),real(-295.997559),real(200.520920),real(35.991051),real(54.226742),real(-195.749161));
 A(6,4) = Mat3(real(-132.482971),real(-27.877882),real(-118.589294),real(-324.963562),real(-159.691879),real(73.855682),real(34.220558),real(319.620972),real(47.392464));
 A(6,5) = Mat3(real(18.232330),real(274.606476),real(189.106033),real(165.505447),real(-269.345917),real(407.200439),real(-181.441620),real(94.167084),real(-176.861267));
 A(6,6) = Mat3(real(783.833618),real(119.328514),real(-71.719810),real(119.328514),real(1030.440063),real(-551.269409),real(-71.719810),real(-551.269409),real(844.579773));
 A(6,7) = Mat3(real(131.885208),real(-72.657532),real(15.368064),real(29.586115),real(-22.101505),real(-293.055847),real(182.712402),real(188.191971),real(63.629211));
 A(7,0) = Mat3(real(13.540226),real(200.745087),real(-50.982849),real(-44.569321),real(-252.523224),real(-250.236374),real(-205.185364),real(1.681608),real(304.973022));
 A(7,1) = Mat3(real(119.772461),real(30.831856),real(-59.478081),real(277.950531),real(290.153961),real(15.850964),real(338.472046),real(267.308319),real(-104.486237));
 A(7,2) = Mat3(real(-77.939354),real(-3.526421),real(143.107010),real(178.658264),real(266.792694),real(-198.409943),real(239.543823),real(-282.877625),real(-45.964851));
 A(7,3) = Mat3(real(-44.807171),real(-404.673798),real(-197.906464),real(49.193714),real(-40.797577),real(44.263531),real(-86.210236),real(39.505875),real(-54.136658));
 A(7,4) = Mat3(real(-182.773209),real(-13.760731),real(234.101196),real(-253.330185),real(-10.092712),real(141.093765),real(292.455170),real(-140.026932),real(-93.105217));
 A(7,5) = Mat3(real(137.881577),real(207.441086),real(119.870560),real(247.737000),real(-22.098175),real(-249.249252),real(38.357529),real(65.562012),real(-208.048676));
 A(7,6) = Mat3(real(131.885208),real(29.586115),real(182.712402),real(-72.657532),real(-22.101505),real(188.191971),real(15.368064),real(-293.055847),real(63.629211));
 A(7,7) = Mat3(real(794.055298),real(-167.436737),real(39.316040),real(-167.436737),real(815.535217),real(1.918896),real(39.316040),real(1.918896),real(897.709595));
 b[0] = Vec3(real(-12211.367188), real(4555.190430), real(5929.195313));
 b[1] = Vec3(real(-12657.294922), real(-11591.426758), real(-1994.103516));
 b[2] = Vec3(real(2345.738281), real(2858.628418), real(13035.013672));
 b[3] = Vec3(real(-12606.539063), real(-9911.821289), real(7589.670410));
 b[4] = Vec3(real(722.438965), real(-11604.360352), real(2143.068604));
 b[5] = Vec3(real(5097.715820), real(-19179.900391), real(9038.442383));
 b[6] = Vec3(real(-5431.094727), real(17753.650391), real(-14339.688477));
 b[7] = Vec3(real(810.577698), real(-9285.605469), real(956.618408));
 x0[0] = Vec3(real(0.000000), real(0.000000), real(0.000000));
 x0[1] = Vec3(real(0.000000), real(0.000000), real(0.000000));
 x0[2] = Vec3(real(0.000000), real(0.000000), real(0.000000));
 x0[3] = Vec3(real(0.000000), real(0.000000), real(0.000000));
 x0[4] = Vec3(real(0.000000), real(0.000000), real(0.000000));
 x0[5] = Vec3(real(0.000000), real(0.000000), real(0.000000));
 x0[6] = Vec3(real(0.000000), real(0.000000), real(0.000000));
 x0[7] = Vec3(real(0.000000), real(0.000000), real(0.000000));
 expected[0] = Vec3(real(-2.943510), real(-3.771783), real(8.503372));
 expected[1] = Vec3(real(0.776696), real(-8.735313), real(4.075747));
 expected[2] = Vec3(real(4.211249), real(3.908505), real(7.076327));
 expected[3] = Vec3(real(-6.907254), real(-8.403882), real(7.076327));
 expected[4] = Vec3(real(-4.296091), real(-9.491562), real(-3.635670));
 expected[5] = Vec3(real(0.983612), real(-8.428297), real(3.453169));
 expected[6] = Vec3(real(-4.075747), real(7.007966), real(-0.262154));
 expected[7] = Vec3(real(-0.815760), real(-8.793908), real(4.243599));
}

struct BlockMatrixConfig
{
 BlockMatrixConfig()
 {
  mDim = 2;
  mMaxIterations = 100;
  mTolerance = real(.0000001);
  mErrorThreshold = real(0.1);
 }

 uint mDim;
 uint mMaxIterations;
 real mTolerance;
 real mErrorThreshold;
};

template <typename SolverType, typename PolicyType, typename TestFunctor>
void TestBlockMatrix(CppUnitLite::TestResult& result_,const char * m_name, BlockMatrixConfig& config, TestFunctor functor)
{
 Math::BlockVector3 b;
 Math::BlockVector3 expected;
 Math::BlockMatrix3 A;
 Math::BlockVector3 x0;

 x0.SetSize(config.mDim);
 A.SetSize(config.mDim);
 expected.SetSize(config.mDim);
 b.SetSize(config.mDim);

 functor(A,b,expected,x0);

 SolverType solver;
 PolicyType policy;
 solver.mMaxIterations = config.mMaxIterations;
 solver.mErrorTolerance = config.mTolerance;

 solver.Solve(A,b,x0,policy);

 CHECK_BLOCK_VEC3_CLOSE(expected, x0, config.mDim, config.mErrorThreshold);
}

#define CreateTest(SolverType, PolicyType, testName, testToRun, dimension, maxIterations) \
 TEST(testName##_BlockMatSuite_##testToRun)                                               \
 {                                                                                        \
  BlockMatrixConfig config;                                                               \
  config.mMaxIterations = maxIterations;                                                  \
  config.mDim = dimension;                                                                \
  TestBlockMatrix<SolverType,PolicyType>(result_,m_name,config,testToRun);                \
 }

#define TestBlockMatrices(SolverType, PolicyType, testName, maxIterations)   \
 CreateTest(SolverType, PolicyType,testName,MatrixDim1Test1,1,maxIterations) \
 CreateTest(SolverType, PolicyType,testName,MatrixDim2Test1,2,maxIterations) \
 CreateTest(SolverType, PolicyType,testName,MatrixDim3Test1,3,maxIterations) \
 CreateTest(SolverType, PolicyType,testName,MatrixDim4Test1,4,maxIterations) \
 CreateTest(SolverType, PolicyType,testName,MatrixDim4Test2,4,maxIterations) \
 CreateTest(SolverType, PolicyType,testName,MatrixDim4Test3,4,maxIterations) \
 CreateTest(SolverType, PolicyType,testName,MatrixDim5Test1,5,maxIterations) \
 CreateTest(SolverType, PolicyType,testName,MatrixDim6Test1,6,maxIterations) \
 CreateTest(SolverType, PolicyType,testName,MatrixDim7Test1,7,maxIterations) \
 CreateTest(SolverType, PolicyType,testName,MatrixDim8Test1,8,maxIterations)

#define RandomTestBlockMatrices(SolverType, PolicyType, testName, maxIterations, dim, testsToRun) \
  TEST(testName##_BlockMat_Random)                                                                \
  {                                                                                               \
    for(uint iteration = 0; iteration < testsToRun; ++iteration)                                  \
    {                                                                                             \
      SolverType solver;                                                                          \
      BlockVec3 b,expected,x0;                                                                    \
      BlockMat3 A;                                                                                \
      x0.SetSize(dim);                                                                            \
                                                                                                  \
      GeneratePosDefBlockMat3(dim,A,expected,b,real(1.0));                                        \
      solver.mMaxIterations = maxIterations;                                                      \
      PolicyType policy;                                                                          \
                                                                                                  \
      solver.Solve(A,b,x0,policy);                                                                \
                                                                                                  \
      CHECK_BLOCK_VEC3_CLOSE(expected, x0, dim, real(0.1));                                       \
    }                                                                                             \
  }
